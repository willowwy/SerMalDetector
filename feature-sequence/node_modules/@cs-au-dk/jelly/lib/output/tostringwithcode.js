"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.constraintVarToStringWithCode = exports.getTokenLocation = exports.funcToStringWithCode = void 0;
const constraintvars_1 = require("../analysis/constraintvars");
const files_1 = require("../misc/files");
const tokens_1 = require("../analysis/tokens");
function funcToStringWithCode(info) {
    return `'${(0, files_1.codeFromLocation)(info.node.loc)}'${info}`;
}
exports.funcToStringWithCode = funcToStringWithCode;
function getTokenLocation(token) {
    if (token instanceof tokens_1.FunctionToken) {
        if (token.fun.loc)
            return token.fun.loc;
    }
    else if (token instanceof tokens_1.AllocationSiteToken) {
        if (token.allocSite.loc)
            return token.allocSite.loc;
    }
    return undefined;
}
exports.getTokenLocation = getTokenLocation;
function constraintVarToStringWithCode(v) {
    if (v instanceof constraintvars_1.NodeVar || v instanceof constraintvars_1.IntermediateVar) {
        if (v.toString().startsWith("'"))
            return v.toString();
        return `'${(0, files_1.codeFromLocation)(v.node.loc)}'${v.toString()}`;
    }
    else if (v instanceof constraintvars_1.ObjectPropertyVar)
        return `${v.toString()}${(0, files_1.codeFromLocation)(getTokenLocation(v.obj)) === "-" ? "" : ` (Object is "${(0, files_1.codeFromLocation)(getTokenLocation(v.obj))}")`}`;
    else if (v instanceof constraintvars_1.ArgumentsVar || v instanceof constraintvars_1.FunctionReturnVar || v instanceof constraintvars_1.ThisVar)
        return `${v.toString()}${(0, files_1.codeFromLocation)(v.fun.loc) === "-" ? "" : ` (Function is "${(0, files_1.codeFromLocation)(v.fun.loc)}")`}`;
    else
        return v.toString();
}
exports.constraintVarToStringWithCode = constraintVarToStringWithCode;
//# sourceMappingURL=tostringwithcode.js.map