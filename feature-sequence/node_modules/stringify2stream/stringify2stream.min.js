!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.Stringify2stream=n()}(this,function(){"use strict";function p(t,n,e,o,f,i){var r=void 0===o?f:f+o;Array.isArray(t)?function(t,n,e,o,f,i,r){n("[");for(var u=0;u<t.length;u++){if(void 0!==o&&n("\n"+r),v(t[u]))n("null");else{var a=t[u];if(e&&"function"==typeof e){var c=e(u.toString(),t[u]);if(v(c)){n("null"),u!==t.length-1&&n(",");continue}a=c}p(a,n,e,o,r,{type:1,index:u})}u!==t.length-1&&n(",")}void 0!==o&&0<t.length&&n("\n"+f);n("]")}(t,n,e,o,f,0,r):"string"==typeof t||t instanceof String?n(d(t.toString())):"boolean"==typeof t||t instanceof Boolean||"number"==typeof t||t instanceof Number?n(""+t.toString()):null===t?n("null"):t instanceof Date?n(d(t.toISOString())):"object"==typeof t&&function(o,f,i,r,t,n,u){if("function"==typeof o.toJSON)y=o,s=f,0===(l=n).type?s(d(y.toJSON(""))):1===l.type?s(d(y.toJSON(l.index.toString()))):s(d(y.toJSON(l.propertyName)));else{f("{");var a=!1,e=function(n){var t=o[n];if(v(t))return"continue";if(i)if("function"==typeof i){var e=i(n,t);if(v(e))return"continue";t=e}else if(Array.isArray(i)&&i.every(function(t){return t!==n}))return"continue";a&&f(","),f(void 0!==r?"\n"+u+d(n)+": ":d(n)+":"),a=!0,p(t,f,i,r,u,{type:2,propertyName:n})};for(var c in o)e(c);void 0!==r&&0<Object.keys(o).length&&f("\n"+t),f("}")}var y,s,l}(t,n,e,o,f,i,r)}function v(t){return void 0===t||"function"==typeof t||"symbol"==typeof t}var n=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function d(t){return n.lastIndex=0,n.test(t)?'"'+t.replace(n,function(t){var n=e[t];return"string"==typeof n?n:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}return function(t,n,e,o){if(v(t))n(void 0);else{var f;if("number"==typeof o&&!isNaN(o)&&1<=o){f="";for(var i=Math.min(Math.floor(o),10),r=0;r<i;r++)f+=" "}else"string"==typeof o&&(f=o.substring(0,10));p(t,n,e,f,"",{type:0})}}});
